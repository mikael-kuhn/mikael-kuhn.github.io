<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2016/12 | Code Playground</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Code Playground">
<meta property="og:url" content="http://blog.codeplayground.org/archives/2016/12/index.html">
<meta property="og:site_name" content="Code Playground">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Code Playground">
  
    <link rel="alternative" href="/atom.xml" title="Code Playground" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-3286820-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Code Playground</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Learning something daily</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Building-a-basic-REST-aspnet-core-example-Part-3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/12/Building-a-basic-REST-aspnet-core-example-Part-3/" class="article-date">
  <time datetime="2016-12-12T12:04:13.000Z" itemprop="datePublished">Dec 12 2016</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/12/Building-a-basic-REST-aspnet-core-example-Part-3/">Building a basic REST AspNet Core Example - Part 3 </a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In the previous <a href="/2016/12/08/Building-a-basic-REST-aspnet-core-example/" title="part 1">part 1</a> &amp; <a href="/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/" title="2">2</a> we build an invoices controller with support for POST/PUT/GET/PATCH http methods. In this one we will add HTTP HEAD method and ETag support  - I’ll repeat the disclamer - It is going to be pretty naive and basic, but I will add to it in future posts (hopefully). The source code for this post is at <a href="https://github.com/mikael-kuhn/basic-rest/tree/master/3_Invoice_Api" target="_blank" rel="external">github</a>.</p>
<h2 id="Adding-HTTP-HEAD-support"><a href="#Adding-HTTP-HEAD-support" class="headerlink" title="Adding HTTP HEAD support"></a>Adding HTTP HEAD support</h2><p>You can read about the HEAD verb in the <a href="https://tools.ietf.org/html/rfc7231#section-4.3.2" target="_blank" rel="external">HTTP protocol</a>. But the part we are interested in is</p>
<blockquote>
<p>The HEAD method is identical to GET except that the server MUST NOT send a message body in the response (i.e., the response terminates at the end of the header section).  The server SHOULD send the same header fields in response to a HEAD request as it would have sent if the request had been a GET, except that the payload header fields MAY be omitted</p>
</blockquote>
<p>The verb is useful for existence checking, validation that you have the latest version etc. Here we will use it for existance checking to start with. We will omit the Content-Length header since it is allowed to do so, and our use case does not rely on it.</p>
<p>So let’s add a minimum implementation to the InvoicesController</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[HttpHead(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">HeadForInvoice</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">&#123;</div><div class="line">    Response.ContentType = ApiDefinition.ApiMediaType;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!invoiceRepository.Exists(id))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> Ok();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>We’d still like to return the Content-Type so thus we set it on the response. </p>
<p>The solution is still only at <a href="http://martinfowler.com/articles/richardsonMaturityModel.html" target="_blank" rel="external">richardson’s maturity model</a> level 2. And we can do better in multiple areas.</p>
<h2 id="ETag-If-match-If-none-match"><a href="#ETag-If-match-If-none-match" class="headerlink" title="ETag, If-match, If-none-match"></a>ETag, If-match, If-none-match</h2><p>Until now we have not really cared if our PUT call tries to update something even though it may have a stale view of the resource. The <a href="https://tools.ietf.org/html/rfc7232#section-2.3" target="_blank" rel="external">ETag header</a> can help us here. We can specify the current entity version on GET response with an ETag header. When we do a PUT we can then specify the “If-match” header with the ETag. Thus we will only update the resource if the ETag matches. But to use the ETag we would want to use it on most Http verbs. The example below uses the invoice version as the ETag - in principle this should have been an “opaque” value instead.</p>
<h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p>We should return an ETag in the response when a GET request is made. It could be done like this (somewhat clumpsy)</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[HttpGet(<span class="string">"&#123;id&#125;"</span>, Name = <span class="string">"GetInvoice"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Get</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">var</span> invoice = invoiceRepository.Get(id);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (invoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;invoice.Version&#125;</span>\""</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> Ok(getInvoiceMapper.ToModel(invoice));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Please note the invoice has been extended with a Version property that is changed when the update method of the repository is called.</p>
<p>So now when we make a request the response headers can look like this</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</div><div class="line">Date: Mon, <span class="number">12</span> Dec <span class="number">2016</span> <span class="number">16</span>:<span class="number">21</span>:<span class="number">21</span> GMT</div><div class="line">Transfer-Encoding: chunked</div><div class="line">Content-Type: application/vnd.restexample.finance+json; charset=utf<span class="number">-8</span></div><div class="line">ETag: <span class="string">"e90baf01-40ce-4f46-89ea-227bb32fc421"</span></div><div class="line">Server: Kestrel</div></pre></td></tr></table></figure>
<p>We should also be able to handle the ETag if specified in the request. It will make sense to implement support for If-none-match header. We will return a new entity if the ETag does not match the current version of the invoice. If it matches we will return HTTP Not Modified.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">[HttpGet(<span class="string">"&#123;id&#125;"</span>, Name = <span class="string">"GetInvoice"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Get</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">var</span> invoice = invoiceRepository.Get(id);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (invoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> currentETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;invoice.Version&#125;</span>\""</span>);</div><div class="line">    <span class="keyword">if</span> (IfMatchGivenIfNoneMatch(currentETag))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> StatusCode((<span class="keyword">int</span>)HttpStatusCode.NotModified);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = currentETag;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> Ok(getInvoiceMapper.ToModel(invoice));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">bool</span> <span class="title">IfMatchGivenIfNoneMatch</span>(<span class="params">EntityTagHeaderValue currentETag</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">var</span> requestHeaders = Request.GetTypedHeaders();</div><div class="line">    <span class="keyword">return</span> requestHeaders.IfNoneMatch != <span class="literal">null</span> &amp;&amp;</div><div class="line">           requestHeaders.IfNoneMatch.Contains(currentETag);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>So now we can add the If-None-Match header to our request like this</p>
<p>If-None-Match: “e90baf01-40ce-4f46-89ea-227bb32fc421”</p>
<p>and if it is current we get these response headers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 304 Not Modified</div><div class="line">Date: Mon, 12 Dec 2016 17:28:02 GMT</div><div class="line">Server: Kestrel</div></pre></td></tr></table></figure>
<h3 id="PUT-PATCH"><a href="#PUT-PATCH" class="headerlink" title="PUT/PATCH"></a>PUT/PATCH</h3><p>Here we are going to return HTTP status Precondition Failed (415) if an ETag is provided and it does not match. The request should have the If-Match header added to it. Here is PUT</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">[HttpPut(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Put</span>(<span class="params"><span class="keyword">string</span> id, [FromBody] UpdateInvoice updateInvoice</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (updateInvoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!invoiceRepository.Exists(id))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (IfMatchIsInvalid(invoiceRepository.GetCurrentVersion(id)))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> StatusCode((<span class="keyword">int</span>) HttpStatusCode.PreconditionFailed);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> newVersion = invoiceRepository.Update(updateInvoiceMapper.ToDomain(</div><div class="line">        updateInvoice, id)).Value;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;newVersion&#125;</span>\""</span>);;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">bool</span> <span class="title">IfMatchIsInvalid</span>(<span class="params"><span class="keyword">string</span> currentVersion</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">var</span> requestHeaders = Request.GetTypedHeaders();</div><div class="line">    <span class="keyword">var</span> currentETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;currentVersion&#125;</span>\""</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> requestHeaders.IfMatch != <span class="literal">null</span> &amp;&amp;</div><div class="line">           !requestHeaders.IfMatch.Any(ifm =&gt; ifm.Equals(EntityTagHeaderValue.Any))</div><div class="line">           &amp;&amp; !requestHeaders.IfMatch.Contains(currentETag);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The ETag can be specified as * thus we also check against EntityTagHeaderValue.Any.</p>
<p>We do the same for PATCH</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">[HttpPatch(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Patch</span>(<span class="params"><span class="keyword">string</span> id, [FromBody] JsonPatchDocument&lt;UpdateInvoice&gt; patchDocument</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (patchDocument == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> invoice = invoiceRepository.Get(id);</div><div class="line">    <span class="keyword">if</span> (invoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (IfMatchIsInvalid(invoice.Version))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> StatusCode((<span class="keyword">int</span>) HttpStatusCode.PreconditionFailed);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> updateInvoice = updateInvoiceMapper.ToModel(invoice);</div><div class="line">    patchDocument.ApplyTo(updateInvoice, ModelState);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> updatedDomainInvoice = updateInvoiceMapper.ToDomain(updateInvoice, id);</div><div class="line">    <span class="keyword">var</span> newVersion = invoiceRepository.Update(updatedDomainInvoice);</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;newVersion&#125;</span>\""</span>);;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h3><p>HEAD should behave like GET so we can take that logic<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[HttpHead(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">HeadForInvoice</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">&#123;</div><div class="line">    Response.ContentType = ApiDefinition.ApiMediaType;</div><div class="line">    Response.GetTypedHeaders();</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!invoiceRepository.Exists(id))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> currentVersion = invoiceRepository.GetCurrentVersion(id);</div><div class="line">    <span class="keyword">var</span> currentETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;currentVersion&#125;</span>\""</span>);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (IfMatchGivenIfNoneMatch(currentETag))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> StatusCode((<span class="keyword">int</span>)HttpStatusCode.NotModified);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = currentETag;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> Ok();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>POST should return an ETag</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">[HttpPost]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Post</span>(<span class="params">[FromBody] UpdateInvoice updateInvoice</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (updateInvoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> createdInvoice = invoiceRepository.Create(updateInvoiceMapper.ToDomain(updateInvoice));</div><div class="line"></div><div class="line">    <span class="keyword">var</span> responseHeaders = Response.GetTypedHeaders();</div><div class="line">    responseHeaders.ETag = <span class="keyword">new</span> EntityTagHeaderValue(<span class="string">$"\"<span class="subst">&#123;createdInvoice.Version&#125;</span>\""</span>);;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> CreatedAtRoute(<span class="string">"GetInvoice"</span>,</div><div class="line">        <span class="keyword">new</span> &#123; id = createdInvoice.Id &#125;,</div><div class="line">        getInvoiceMapper.ToModel(createdInvoice));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap-up"></a>Wrap-up</h2><p>That is it for the most basic api for now. But we can do more as we will see in later posts (hopefully).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.codeplayground.org/2016/12/12/Building-a-basic-REST-aspnet-core-example-Part-3/" data-id="ciwm1b88m00018taam2bqkalm" class="article-share-link">Share</a>
      
        <a href="http://blog.codeplayground.org/2016/12/12/Building-a-basic-REST-aspnet-core-example-Part-3/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET-Core/">.NET Core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AspNet-Mvc/">AspNet Mvc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/REST/">REST</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Building-a-basic-REST-aspnet-core-example-Part-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/" class="article-date">
  <time datetime="2016-12-09T09:18:40.000Z" itemprop="datePublished">Dec 9 2016</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/">Building a basic REST AspNet Core Example - Part 2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In the last <a href="/2016/12/08/Building-a-basic-REST-aspnet-core-example/" title="post">post</a> we made the first step at a REST Api. In this post we will improve it by adding HTTP PATCH/OPTIONS support. I’ll repeat the disclamer - It is going to be pretty naive and basic, but I will add to it in future posts (hopefully). The source code for this post is <a href="https://github.com/mikael-kuhn/basic-rest/tree/master/2_Invoice_Api" target="_blank" rel="external">here</a>.</p>
<h2 id="Adding-HTTP-PATCH-support"><a href="#Adding-HTTP-PATCH-support" class="headerlink" title="Adding HTTP PATCH support"></a>Adding HTTP PATCH support</h2><p>With PUT we have to supply the complete invoice in order to update it. That may not be what you want, so <a href="https://tools.ietf.org/html/rfc5789" target="_blank" rel="external">HTTP PATCH (rfc5789)</a> can help us here by allowing partial resource modification.</p>
<blockquote>
<p>The PATCH method requests that a set of changes described in the<br>request entity be applied to the resource identified by the Request-<br>URI.  The set of changes is represented in a format called a “patch<br>document” identified by a media type</p>
</blockquote>
<p>For JSON in .NET core this is implemented using <a href="https://tools.ietf.org/html/rfc6902" target="_blank" rel="external">JavaScript Object Notation (JSON) Patch</a>. The media type is “application/json-patch+json”. From Json Patch you can read</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">A JSON Patch document is a JSON [RFC4627] document that represents an</div><div class="line">array of objects.  Each object represents a single operation to be</div><div class="line">applied to the target JSON document.</div><div class="line"></div><div class="line">The following is an example JSON Patch document, transferred in a HTTP PATCH request:</div><div class="line"></div><div class="line">PATCH /my/data HTTP/1.1</div><div class="line">Host: example.org</div><div class="line">Content-Length: 326</div><div class="line">Content-Type: application/json-patch+json</div><div class="line">If-Match: &quot;abc123&quot;</div><div class="line"></div><div class="line">[</div><div class="line"> &#123; &quot;op&quot;: &quot;test&quot;, &quot;path&quot;: &quot;/a/b/c&quot;, &quot;value&quot;: &quot;foo&quot; &#125;,</div><div class="line"> &#123; &quot;op&quot;: &quot;remove&quot;, &quot;path&quot;: &quot;/a/b/c&quot; &#125;,</div><div class="line"> &#123; &quot;op&quot;: &quot;add&quot;, &quot;path&quot;: &quot;/a/b/c&quot;, &quot;value&quot;: [ &quot;foo&quot;, &quot;bar&quot; ] &#125;,</div><div class="line"> &#123; &quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/a/b/c&quot;, &quot;value&quot;: 42 &#125;,</div><div class="line"> &#123; &quot;op&quot;: &quot;move&quot;, &quot;from&quot;: &quot;/a/b/c&quot;, &quot;path&quot;: &quot;/a/b/d&quot; &#125;,</div><div class="line"> &#123; &quot;op&quot;: &quot;copy&quot;, &quot;from&quot;: &quot;/a/b/d&quot;, &quot;path&quot;: &quot;/a/b/e&quot; &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p>So { “op”: “replace”, “path”: “/a/b/c”, “value”: 42 } tells us that the operation should replace the target value with 42. The path is a <a href="https://tools.ietf.org/html/rfc6901" target="_blank" rel="external">JSON Pointer</a>. If you want to take a look at the aspnet source code then look <a href="https://github.com/aspnet/JsonPatch" target="_blank" rel="external">here</a>. From the unit test you can also see that the “test” operation is not supported.</p>
<p>So let us extend our InvoicesController</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">[HttpPatch(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Patch</span>(<span class="params"><span class="keyword">string</span> id, [FromBody] JsonPatchDocument&lt;UpdateInvoice&gt; patchDocument</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (patchDocument == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> invoice = invoiceRepository.Get(id);</div><div class="line">    <span class="keyword">if</span> (invoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> updateInvoice = updateInvoiceMapper.ToModel(invoice);</div><div class="line">    patchDocument.ApplyTo(updateInvoice, ModelState);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> updatedDomainInvoice = updateInvoiceMapper.ToDomain(updateInvoice, id);</div><div class="line">    invoiceRepository.Update(updatedDomainInvoice);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>In the method our input is now JsonPatchDocument<updateinvoice> meaning it is an UpdateInvoice model we perform the operations on. Again we start out with a validation if the input is malformed. Next we handle the case where the invoice is not found. Since we perform the operations against an instance of UpdateInvoice here, then we must construct that instance first from the domain model. So ToModel transforms the loaded entity to our model representation. Then the patch operations are applied using patchDocument.ApplyTo. We also pass in the ModelState so that the validation will still kick in. After ApplyTo we check the ModelState. Last step it to update the invoice using the repository.</updateinvoice></p>
<h2 id="HTTP-Options"><a href="#HTTP-Options" class="headerlink" title="HTTP Options"></a>HTTP Options</h2><p>To provide a more complete REST Api we can choose to implement the HTTP OPTIONS verb.</p>
<blockquote>
<p>The OPTIONS method represents a request for information about the communication options available on the request/response chain identified by the Request-URI. This method allows the client to determine the options and/or requirements associated with a resource, or the capabilities of a server, without implying a resource action or initiating a resource retrieval. </p>
</blockquote>
<p>Using it we can determine which other Http Verbs that are available at a given uri. We can use this to eg. remove Http Put/Patch methods when no instance exists. The methods that are available should be specified in the <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7" target="_blank" rel="external">allow header</a></p>
<p>Allow: GET, POST, PUT</p>
<p>So let’s add the first OPTIONS method for the /invoices uri</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[HttpOptions]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Options</span>(<span class="params"></span>)</span></div><div class="line">&#123;</div><div class="line">    Response.Headers.Add(<span class="string">"Allow"</span>, <span class="keyword">string</span>.Join(<span class="string">","</span>, HttpVerbs.Options, HttpVerbs.Post));</div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Now when we make a OPTIONS request we get</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 204 No Content</div><div class="line">Date: Mon, 12 Dec 2016 10:22:07 GMT</div><div class="line">Allow: OPTIONS,POST</div></pre></td></tr></table></figure>
<p>basically saying all we can do is create a new invoice.</p>
<p>When we call HTTP OPTIONS on an invoice we should return OPTIONS,GET,PUT,PATCH if the invoice exists. If not then “OPTIONS, GET”. I include GET since it can return a 404 as the response.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[HttpOptions(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">OptionsForInvoice</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (!invoiceRepository.Exists(id))</div><div class="line">    &#123;</div><div class="line">        Response.Headers.Add(<span class="string">"Allow"</span>, <span class="keyword">string</span>.Join(<span class="string">","</span>,</div><div class="line">            HttpVerbs.Options,</div><div class="line">            HttpVerbs.Get));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        Response.Headers.Add(<span class="string">"Allow"</span>, <span class="keyword">string</span>.Join(<span class="string">","</span>,</div><div class="line">            HttpVerbs.Options,</div><div class="line">            HttpVerbs.Get,</div><div class="line">            HttpVerbs.Put,</div><div class="line">            HttpVerbs.Patch));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap up"></a>Wrap up</h2><p>That’s it for this time, but we are still not there so other posts will follow.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.codeplayground.org/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/" data-id="ciwm1b88i00008taane3f5y0m" class="article-share-link">Share</a>
      
        <a href="http://blog.codeplayground.org/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET-Core/">.NET Core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AspNet-Mvc/">AspNet Mvc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/REST/">REST</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Building-a-basic-REST-aspnet-core-example" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/08/Building-a-basic-REST-aspnet-core-example/" class="article-date">
  <time datetime="2016-12-08T18:48:17.000Z" itemprop="datePublished">Dec 8 2016</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/08/Building-a-basic-REST-aspnet-core-example/">Building a basic REST AspNet Core Example - Part 1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In this post we will start on an app that exposes a REST web api for an invoice. Disclaimer - It is going to be pretty naive and basic, but I will add to it in further posts (hopefully). So actually we will for now go no higher in <a href="http://martinfowler.com/articles/richardsonMaturityModel.html" target="_blank" rel="external">richardson’s maturity model</a> than level 2. </p>
<p>My inspiration for this blog is attending <a href="http://www.skillsmatter.co.uk" target="_blank" rel="external">skillsmatters</a> “Fast-Track to RESTful Microservices” course with Jim Webber. It is highly based on the book <a href="https://www.amazon.com/REST-Practice-Hypermedia-Systems-Architecture/dp/0596805829/ref=sr_1_1?ie=UTF8&amp;qid=1481025806&amp;sr=8-1&amp;keywords=rest+in+practice" target="_blank" rel="external">REST in Practice: Hypermedia and Systems Architecture</a>. Although the book is now old it still contains good information (code examples are naturally outdated) - so read it if you need extensive REST information, but can live with not all is up to date.</p>
<p>The case here is creating, updating and getting an invoice along the lines of these user stories. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">As a &lt;business user&gt; </div><div class="line">I want &lt;to be able to create an invoice for a customer&gt;</div><div class="line">So that &lt;we can facilitate sales&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">As a &lt;business user&gt; </div><div class="line">I want &lt;to be able to update an invoice&gt;</div><div class="line">So that &lt;it can be created in steps&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">As a &lt;business user&gt; </div><div class="line">I want &lt;to be able to view the invoice&gt;</div><div class="line">So that &lt;I can answer questions related to it&gt;</div></pre></td></tr></table></figure>
<p>Getting a list of invoices, searching etc is too advanced for now.</p>
<p>The server code will be .NET core aspnet web api (and for the fun I’m developing on ubuntu with Jetbrains Rider). It will be without a real database backing it for now - since the focus is mostly on the REST part. It does take a pretty naive approach on design of the API, but hopefully I will get to a post where this part is evolved.</p>
<p>You can find the code discussed at <a href="https://github.com/mikael-kuhn/basic-rest/tree/master/1_Invoice_Api" target="_blank" rel="external">github</a> in the 1_InvoiceApi folder.</p>
<h2 id="The-Domain"><a href="#The-Domain" class="headerlink" title="The Domain"></a>The Domain</h2><p>We will call our bounded context finance, and the primary class will be the invoice. We will start with this naive definition</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Finance.Domain.Domain</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">Invoice</span></div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Invoice</span>(<span class="params"><span class="keyword">string</span> id, DateTimeOffset invoiceDate,</span></span></div><div class="line">            DateTimeOffset dueDate,</div><div class="line">            InvoiceCustomer invoiceCustomer,</div><div class="line">            IEnumerable&lt;InvoiceLine&gt; lines)</div><div class="line">        &#123;</div><div class="line">            InvoiceDate = invoiceDate;</div><div class="line">            DueDate = dueDate;</div><div class="line">            Customer = invoiceCustomer;</div><div class="line">            Lines = lines;</div><div class="line">            Id = id;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">        <span class="keyword">public</span> DateTimeOffset InvoiceDate &#123; <span class="keyword">get</span>; &#125;</div><div class="line">        <span class="keyword">public</span> DateTimeOffset DueDate &#123; <span class="keyword">get</span>; &#125;</div><div class="line">        <span class="keyword">public</span> InvoiceCustomer Customer &#123; <span class="keyword">get</span>; &#125;</div><div class="line">        <span class="keyword">public</span> IEnumerable&lt;InvoiceLine&gt; Lines &#123; <span class="keyword">get</span>; &#125;</div><div class="line">		<span class="keyword">public</span> Amount SubTotal =&gt; <span class="keyword">new</span> Amount(Lines.Sum(l =&gt; l.Total.Value));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The customer and lines are not important for understanding at present time.</p>
<h2 id="The-repository"><a href="#The-repository" class="headerlink" title="The repository"></a>The repository</h2><p>The invoice is accompanied with an InvoiceReposity class implementing IRepository&lt;Invoice&gt; that looks like this</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public interface IRepository&lt;T&gt;</div><div class="line">&#123;</div><div class="line">    T Get(string id);</div><div class="line">    void Update(T instance);</div><div class="line">    T Create(T instance);</div><div class="line">    bool Exists(string id);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>for now we have a list of 1000 prepopulated invoices with id 1-1000. The repository is a simple dictionary.</p>
<h2 id="Looking-for-the-API"><a href="#Looking-for-the-API" class="headerlink" title="Looking for the API"></a>Looking for the API</h2><p>We will center the API around what the business does - that is its domain and the mentioned user stories. With Level 1 in the REST maturity level with introduce resource representations. We use urls to differentiate between these resource representations. So in our case it will be an invoice resource representation. Remember the resource representation does not have to match our domain model. It will be designed from what information we wish to conway, and we may have multiple resource representations for the same domain invoice.</p>
<p>So since we are going for a CRU(D) implementation here our invoice API can look like this</p>
<table>
<thead>
<tr>
<th>Http Verb</th>
<th>Uri</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>invoices/{id}</td>
<td>Get invoice representation</td>
</tr>
<tr>
<td>POST</td>
<td>invoices</td>
<td>Create a new invoice</td>
</tr>
<tr>
<td>PUT</td>
<td>invoices/{id}</td>
<td>Update an existing invoice</td>
</tr>
</tbody>
</table>
<p>Actually we are already getting a good start on Level 2 Http in the maturity model. We are using the <a href="https://www.w3.org/Protocols/rfc2616/rfc2616.html" target="_blank" rel="external">Http protocol</a> verbs, and we must make sure to use status codes correctly, content types and all the other good stuff (safe verbs and idempotency). Now you could ask where the GET invoice/ is. For now it is not there - remember we had 1000 invoices prepopulated - it will need a little more design.</p>
<h3 id="Deciding-on-a-media-type"><a href="#Deciding-on-a-media-type" class="headerlink" title="Deciding on a media type"></a>Deciding on a media type</h3><p>We need to chose a <a href="https://en.wikipedia.org/wiki/Media_type" target="_blank" rel="external">media type</a> for the http calls. Since json is “in” at the moment we could choose application/json. However we would like to have something less general purpose to be able to tell the client about the expected processing model (like introduce hypermedia later). So we create a media type in the vendor tree</p>
<p>application/vnd.restexample.finance+json</p>
<p>assuming we as the owner are called “restexample”. We also added the application name “finance”, but should probably not break it further down, since it will put demands on the client if we have multiple media types. The suffix +json now tells what the underlying representation is.</p>
<p>So in order for us to return any information the client must specify the http header</p>
<p>Accept: application/vnd.restexample.finance+json</p>
<p>or any variant such as */*, application/*.</p>
<p>To enforce the media type we add the following to the Startup class. </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ConfigureServices</span>(<span class="params">IServiceCollection services</span>)</span></div><div class="line">&#123;</div><div class="line">    services.AddMvc(LimitFormattersToThisApplication);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LimitFormattersToThisApplication</span>(<span class="params">MvcOptions options</span>)</span></div><div class="line">&#123;</div><div class="line">    options.RespectBrowserAcceptHeader = <span class="literal">true</span>;</div><div class="line">    options.ReturnHttpNotAcceptable = <span class="literal">true</span>;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> customMediaType = <span class="keyword">new</span> MediaTypeHeaderValue(ApiDefinition.ApiMediaType);</div><div class="line"></div><div class="line">    options.SetInputMediaType(customMediaType);</div><div class="line">    options.SetOutputMediaType(customMediaType);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MvcOptionsExtensions</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetInputMediaType</span>(<span class="params"><span class="keyword">this</span> MvcOptions options, MediaTypeHeaderValue mediaType</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> supportedInputMediaTypes = options</div><div class="line">            .InputFormatters</div><div class="line">            .OfType&lt;JsonInputFormatter&gt;()</div><div class="line">            .First()</div><div class="line">            .SupportedMediaTypes;</div><div class="line"></div><div class="line">        SetAllowedMediaType(mediaType, supportedInputMediaTypes);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetOutputMediaType</span>(<span class="params"><span class="keyword">this</span> MvcOptions options, MediaTypeHeaderValue mediaType</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> supportedOutputMediaTypes = options</div><div class="line">            .OutputFormatters</div><div class="line">            .OfType&lt;JsonOutputFormatter&gt;()</div><div class="line">            .First()</div><div class="line">            .SupportedMediaTypes;</div><div class="line"></div><div class="line">        SetAllowedMediaType(mediaType, supportedOutputMediaTypes);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SetAllowedMediaType</span>(<span class="params">MediaTypeHeaderValue mediaType,</span></span></div><div class="line">        MediaTypeCollection supportedInputMediaTypes)</div><div class="line">    &#123;</div><div class="line">        supportedInputMediaTypes.Clear();</div><div class="line">        supportedInputMediaTypes.Add(mediaType);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The extension methods sets the output and input media type. Note ReturnHttpNotAcceptable is set to true in order to return </p>
<p>406 Not Acceptable</p>
<p>when the reponse format requested in the accept header does not match our custom media type.</p>
<h3 id="Invoice-resource-representation"><a href="#Invoice-resource-representation" class="headerlink" title="Invoice resource representation"></a>Invoice resource representation</h3><h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h4><p>For now we will use this invoice representation for GET that matches the domain representation except for some value object representations in the domain (DDD term)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="attr">"id"</span>: <span class="string">"1000"</span>,</div><div class="line">	<span class="attr">"invoiceDate"</span>: <span class="string">"2016-12-05T00:00Z"</span>,</div><div class="line">	<span class="attr">"dueDate"</span>: <span class="string">"2016-12-12T00:00Z"</span>,</div><div class="line">	<span class="attr">"subTotal"</span>: <span class="number">9050</span>,</div><div class="line">	<span class="attr">"customer"</span>: &#123;</div><div class="line">		<span class="attr">"name"</span>: <span class="string">"Microsoft Development Center"</span>,</div><div class="line">		<span class="attr">"addressLines"</span>: [<span class="string">"Kanalvej 8"</span>, <span class="string">"2800 Kongens Lyngby"</span>]</div><div class="line">	&#125;,</div><div class="line">	<span class="attr">"lines"</span>: [</div><div class="line">		&#123; </div><div class="line">			<span class="attr">"lineNumber"</span>: <span class="number">1</span>, </div><div class="line">			<span class="attr">"description"</span>: <span class="string">"consultancy"</span>, </div><div class="line">			<span class="attr">"quantity"</span>: <span class="number">10</span>, </div><div class="line">			<span class="attr">"itemPrice"</span>: <span class="number">905</span>, </div><div class="line">			<span class="attr">"total"</span>: <span class="number">9050</span> </div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>That raises the question of what happens to “total” values on POST or PUT. The answer is we need a different representation without these fields. </p>
<h4 id="PUT-POST"><a href="#PUT-POST" class="headerlink" title="PUT/POST"></a>PUT/POST</h4><p>Besides removing the total values in the resource representation we also remove the id, ie. we will not let it be up to the client to set it (could be a valid option).</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="attr">"invoiceDate"</span>: <span class="string">"2016-12-05T00:00Z"</span>,</div><div class="line">	<span class="attr">"dueDate"</span>: <span class="string">"2016-12-12T00:00Z"</span>,</div><div class="line">	<span class="attr">"customer"</span>: &#123;</div><div class="line">		<span class="attr">"name"</span>: <span class="string">"Microsoft Development Center"</span>,</div><div class="line">		<span class="attr">"addressLines"</span>: [<span class="string">"Kanalvej 8"</span>, <span class="string">"2800 Kongens Lyngby"</span>]</div><div class="line">	&#125;,</div><div class="line">	<span class="attr">"lines"</span>: [</div><div class="line">		&#123; </div><div class="line">			<span class="attr">"lineNumber"</span>: <span class="number">1</span>, </div><div class="line">			<span class="attr">"description"</span>: <span class="string">"consultancy"</span>, </div><div class="line">			<span class="attr">"quantity"</span>: <span class="number">10</span>, </div><div class="line">			<span class="attr">"itemPrice"</span>: <span class="number">905</span></div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="The-Invoice-controller"><a href="#The-Invoice-controller" class="headerlink" title="The Invoice controller"></a>The Invoice controller</h3><p>For now we are not going all in on DDD with a separate application service layer, but rather survive with that code in the controller.</p>
<h4 id="Get"><a href="#Get" class="headerlink" title="Get"></a>Get</h4><p>So here is the GET implementation</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[Route(<span class="string">"invoice"</span>)]</div><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">InvoicesController</span> : <span class="title">Controller</span></div><div class="line">&#123;</div><div class="line">...</div><div class="line">    [HttpGet(<span class="string">"&#123;id&#125;"</span>, Name = <span class="string">"GetInvoice"</span>)]</div><div class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Get</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">var</span> invoice = invoiceRepository.Get(id);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (invoice == <span class="literal">null</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">return</span> NotFound();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> Ok(mapper.ToModel(invoice));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ...</div></pre></td></tr></table></figure>
<p>We use a literal in the Route attribute to avoid issues with refactoring. If we cannot find the invoice then we return a 404 Not found. Else we return the invoice. It is mapped to this GET model. Notice the HttpGet specifies a Name. This is used in the Post action later.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">GetInvoice</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> DateTimeOffset InvoiceDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> DateTimeOffset DueDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> GetInvoiceCustomer Customer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> SubTotal &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> IEnumerable&lt;GetInvoiceLine&gt; Lines &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>I am sure GetInvoice will cause some discussion for now. You could do without different representations for the Http verb’s, but then that would impact on the validation etc. That is the reason behind the choice here as you will see in a moment on POST.</p>
<h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h4><p>In post we have more to take into account. </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">[HttpPost]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Post</span>(<span class="params">[FromBody] UpdateInvoice updateInvoice</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (updateInvoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> createdInvoice = invoiceRepository.Create(updateInvoiceMapper.ToDomain(updateInvoice));</div><div class="line"></div><div class="line">    <span class="keyword">return</span> CreatedAtRoute(<span class="string">"GetInvoice"</span>,</div><div class="line">        <span class="keyword">new</span> &#123; id = createdInvoice.Id &#125;,</div><div class="line">        getInvoiceMapper.ToModel(createdInvoice));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>First of all the request could be malformed in such a way that updateInvoice is null. We will return BadRequest then.</p>
<p>Next is to check if the model is valid. This is one of the reasons for having UpdateInvoice, UpdateInvoiceLine, UpdateInvoiceCustomer models where we decorate with data annotations like shown here</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">UpdateInvoice</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> DateTimeOffset InvoiceDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> DateTimeOffset DueDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> UpdateInvoiceCustomer Customer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> IEnumerable&lt;UpdateInvoiceLine&gt; Lines &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">UpdateInvoiceLine</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> LineNumber &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> Quantity &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">decimal</span> ItemPrice &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line"></div><div class="line">    [Required(ErrorMessage = <span class="string">"Invoice line description must be specified"</span>)]</div><div class="line">    [MaxLength(<span class="number">500</span>, ErrorMessage = <span class="string">"Invoice line description is too long"</span>)]</div><div class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Description &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If everything goes well we will return the newly created invoice with a 201 and a Location header for the new resource like shown here</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 201 Created</div><div class="line">Date: Thu, 08 Dec 2016 12:40:35 GMT</div><div class="line">Transfer-Encoding: chunked</div><div class="line">Content-Type: application/vnd.restexample.finance+json; charset=utf-8</div><div class="line">Location: http://localhost:5000/invoice/1002</div><div class="line"></div><div class="line">&#123;</div><div class="line">	&quot;invoiceDate&quot;:&quot;2016-12-05T00:00:00+00:00&quot;,</div><div class="line">	&quot;dueDate&quot;:&quot;2016-12-12T00:00:00+00:00&quot;,</div><div class="line">	&quot;customer&quot;:&#123;</div><div class="line">		&quot;name&quot;:&quot;Microsoft Development Center&quot;,</div><div class="line">		&quot;addressLines&quot;:[&quot;Kanalvej 8&quot;,&quot;2800 Kongens Lyngby&quot;]</div><div class="line">		&#125;,</div><div class="line">	&quot;subTotal&quot;:0.0,</div><div class="line">	&quot;lines&quot;:[</div><div class="line">		&#123;&quot;lineNumber&quot;:1,&quot;description&quot;:&quot;test&quot;,&quot;quantity&quot;:10.0,&quot;itemPrice&quot;:1.0,&quot;total&quot;:10.0&#125;</div><div class="line">	],</div><div class="line">	&quot;id&quot;:&quot;1002&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Note that when calling POST we have to add the headers</p>
<p>Accept: application/vnd.restexample.finance+json<br>Content-Type: application/vnd.restexample.finance+json</p>
<p>However the code here in the POST is not pretty when it comes to DRY, but that will be a topic for a later blog.</p>
<h4 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h4><p>With Put we wish to update the invoice. We must supply the full payload for updating. We will in a later blog look at the Patch verb.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">[HttpPut(<span class="string">"&#123;id&#125;"</span>)]</div><div class="line"><span class="function"><span class="keyword">public</span> IActionResult <span class="title">Put</span>(<span class="params"><span class="keyword">string</span> id, [FromBody] UpdateInvoice updateInvoice</span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (updateInvoice == <span class="literal">null</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!ModelState.IsValid)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> BadRequest(ModelState);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!invoiceRepository.Exists(id))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> NotFound();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    invoiceRepository.Update(updateInvoiceMapper.ToDomain(updateInvoice, id));</div><div class="line"></div><div class="line">    <span class="keyword">return</span> NoContent();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The two first validations are simular to Post. Then we check if the invoice exists and return NotFound if not. If we can update then we return NoContent (the client has the invoice already).</p>
<h2 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap-up"></a>Wrap-up</h2><p>That is it for the most basic api for now. But we can do much more as we will see in later posts (hopefully).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.codeplayground.org/2016/12/08/Building-a-basic-REST-aspnet-core-example/" data-id="ciwm1b88r00048taa5lafwqwq" class="article-share-link">Share</a>
      
        <a href="http://blog.codeplayground.org/2016/12/08/Building-a-basic-REST-aspnet-core-example/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET-Core/">.NET Core</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AspNet-Mvc/">AspNet Mvc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/REST/">REST</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/NET-Core/">.NET Core</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AspNet-Mvc/">AspNet Mvc</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Azure/">Azure</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REST/">REST</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/NET-Core/" style="font-size: 20px;">.NET Core</a> <a href="/tags/AspNet-Mvc/" style="font-size: 20px;">AspNet Mvc</a> <a href="/tags/Azure/" style="font-size: 10px;">Azure</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/REST/" style="font-size: 20px;">REST</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/12/12/Building-a-basic-REST-aspnet-core-example-Part-3/">Building a basic REST AspNet Core Example - Part 3 </a>
          </li>
        
          <li>
            <a href="/2016/12/09/Building-a-basic-REST-aspnet-core-example-Part-2/">Building a basic REST AspNet Core Example - Part 2</a>
          </li>
        
          <li>
            <a href="/2016/12/08/Building-a-basic-REST-aspnet-core-example/">Building a basic REST AspNet Core Example - Part 1</a>
          </li>
        
          <li>
            <a href="/2015/03/04/azure-automation/">Automate VM deployment with Azure + Docker</a>
          </li>
        
          <li>
            <a href="/2015/02/17/idea-behind-this-blog/">Idea behind this blog</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Mikael Kühn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'codeplayground';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>